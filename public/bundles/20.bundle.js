(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{305:function(e,t,a){"use strict";var s=a(0),n=a.n(s),o=a(505),r=a(494),i=a(509);var l=e=>n.a.createElement(o.a,{open:e.open,anchorEl:e.anchorEl,onClose:e.onClose,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"}},n.a.createElement(r.a,{elevation:4,style:{padding:"10px"}},n.a.createElement(i.a,{variant:"contained",color:"primary"},"View Profile"),n.a.createElement(i.a,{variant:"contained",color:"secondary"},"Ban"),n.a.createElement(i.a,{variant:"contained",color:"primary"},"Kick from Queue"))),p=a(111),c=a(70),d=a(246);class h extends s.PureComponent{constructor(e){super(e),this.state={popoverOpen:!1},this.ref=n.a.createRef(),this.handleOpenPopover=this.handleOpenPopover.bind(this),this.handleClosePopover=this.handleClosePopover.bind(this)}handleOpenPopover(){this.setState({popoverOpen:!0})}handleClosePopover(){this.setState({popoverOpen:!1})}render(){return n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{style:this.props.style,onClick:this.handleOpenPopover,ref:e=>{this.ref=e}},this.props.children),n.a.createElement(l,{open:this.state.popoverOpen,onClose:this.handleClosePopover,anchorEl:this.ref}))}}t.a=Object(d.a)(Object(p.a)(e=>({root:{}})),Object(c.b)(e=>({})))(h)},526:function(e,t,a){"use strict";a.r(t);var s=a(0),n=a.n(s),o=a(439),r=a.n(o),i=a(111),l=a(537),p=a(70),c=a(246);class d extends s.PureComponent{constructor(e){super(e)}render(){const{classes:e}=this.props;let t,a=window.location.origin+"/images/badges/";switch(this.props.type){case"dev":a+="DevBadge.png",t="The Developer";break;case"host":a+="AdminBadge.png",t="Host";break;case"mod":a+="ModBadge.png",t="Moderator";break;case"plus":a+="PlusBadge.png",t="This user can use Plus";break;case"sub1":a+="SubBadge1.png",t="Subscriber for 1 month(+)"}return n.a.createElement(l.a,{title:t,placement:"top"},n.a.createElement("img",{className:e.root,src:a}))}}var h=Object(c.a)(Object(i.a)(e=>({root:{width:"22px",marginLeft:"2px",marginRight:"2px",backgroundColor:"#b7b7b7",border:"1px solid #333",borderRadius:"6px",verticalAlign:"middle"}})))(d),g=a(305),m=a(494);class u extends s.PureComponent{constructor(e){super(e)}render(){let{classes:e,text:t,username:a,userid:s,time:o,isReplay:i,isLastMessage:l,accountMap:p}=this.props,c="",d=!1;if("TPNSbot"===s&&"["==t[0]){d=!0;let e=/\[(.+):(.+)\](.+)/,s=t.match(e);c=s[1],a=s[2],t=s[3]}if(!i&&l){let e="@"+this.props.myUsername;t.indexOf(e)}let u=!1;"fosse"!=a&&"remotegames"!=a&&"fossephate"!=a&&"fosse#0430"!=a||(u=!0);let x=[],b=p[s];return b&&(u?x.push(n.a.createElement(h,{type:"dev"})):b.roles.host?x.push(n.a.createElement(h,{type:"host"})):b.roles.mod?x.push(n.a.createElement(h,{type:"mod"})):b.roles.plus&&x.push(n.a.createElement(h,{type:"plus"})),b.roles.sub&&x.push(n.a.createElement(h,{type:"sub1"})),b.roles.mod&&!i&&l&&t.indexOf("@everyone")),x=n.a.Children.toArray(x),n.a.createElement("div",{className:e.root,userid:s,onClick:this.props.onClick},n.a.createElement(r.a,{properties:{className:e.links}},function(e){let t=new Date(e),a=t.getHours();return a=a>12?a-12:a,a+":"+function(e){let t=""+e;for(;t.length<2;)t="0"+t;return t}(t.getMinutes())+" "}(o),x,0==x.length?" ":null,n.a.createElement(g.a,{userid:s,style:{display:"inline"}},n.a.createElement(m.a,{elevation:4,className:e.user},a))," ",n.a.createElement("span",null,t)))}}var x=Object(c.a)(Object(i.a)(e=>({root:{flexWrap:"wrap",backgroundColor:e.isBanned?"#d34c4ca4":null,wordBreak:"break-word",margin:"5px 5px",padding:"5px 10px",fontSize:"14px !important",borderRadius:"5px"},links:{color:"#0000ee"},user:{display:"inline-flex",margin:"0px 2px",padding:"2px 5px",cursor:"pointer"}})),Object(p.b)(e=>({accountMap:e.stream.accountMap,myUsername:e.client.username})))(u),b=a(530),f=a(508),v=a(453),y=a.n(v),E=a(509),C=a(288);function S(){return(S=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e}).apply(this,arguments)}class k extends s.Component{constructor(e){super(e),this.messagesEnd=null,this.rootRef=n.a.createRef(),this.shouldScroll=!1,this.handleClick=this.handleClick.bind(this),this.state={voting:!1}}handleClick(e){}getSnapshotBeforeUpdate(e,t){if(e.messages.length<this.props.messages.length){let e=document.getElementById("messageList");e&&Math.abs(e.scrollHeight-e.scrollTop-e.offsetHeight)<2&&(this.shouldScroll=!0)}return null}componentDidUpdate(e,t,a){if(this.shouldScroll){let e=document.getElementById("messageList");e.scrollTop=e.scrollHeight}this.shouldScroll=!1}mapMessages(){let e=[];for(let t=0;t<this.props.messages.length;t++){let a=t==this.props.messages.length-1;(!this.props.messages[t].isBanned||this.props.isBanned||this.props.isMod)&&e.push(n.a.createElement(x,S({key:t},this.props.messages[t],{isLastMessage:a,onContextMenu:this.handleClick})))}return e}shouldComponentUpdate(e,t){if(!this.state.voting){let t=e.messages[e.messages.length-1];t&&"HostBot"==t.username&&/A vote has been started to/.test(t.text)&&!t.isReplay&&(this.setState({voting:!0}),setTimeout(()=>{this.setState({voting:!1})},18e3))}return!0}render(){const{classes:e}=this.props;return n.a.createElement(m.a,{id:"messageList",className:e.root,elevation:4,ref:e=>{this.rootRef=e}},this.mapMessages(),n.a.createElement("div",{style:{float:"left",clear:"both"},ref:e=>{this.messagesEnd=e}}),n.a.createElement(b.a,{anchorOrigin:{vertical:"top",horizontal:"right"},open:this.state.voting,autoHideDuration:0,onClose:()=>{},message:n.a.createElement("span",{id:"message-id"},"A vote has started to switch games!"),action:[n.a.createElement(E.a,{key:"leave",color:"secondary",size:"small",variant:"contained",onClick:()=>{this.props.sendMessage("yea"),this.setState({voting:!1})}},"LEAVE"),n.a.createElement("div",{key:"spacer",style:{width:"15px"}}),n.a.createElement(E.a,{key:"stay",color:"primary",size:"small",variant:"contained",onClick:()=>{this.props.sendMessage("nay"),this.setState({voting:!1})}},"STAY"),n.a.createElement(f.a,{key:"close",color:"inherit",className:e.close,onClick:()=>{this.setState({voting:!1})}},n.a.createElement(y.a,null))]}))}}var O=Object(c.a)(Object(i.a)(e=>({root:{overflowY:"auto",boxShadow:"none","& > div:nth-child(even)":{color:"dark"===e.palette.type?"#FFF":"#000",backgroundColor:"dark"===e.palette.type?e.palette.primary.dark:e.palette.primary.light},"& > div:nth-child(odd)":{color:"dark"===e.palette.type?"#FFF":"#000",backgroundColor:"dark"===e.palette.type?e.palette.secondary.dark:e.palette.secondary.light},position:"absolute",top:0,left:0,bottom:0,right:0,height:"82%"}})),Object(p.b)(e=>({messages:e.stream.chat.messages,accountMap:e.stream.accountMap,isMod:e.client.roles.mod,isBanned:e.client.isBanned}),e=>({sendMessage:t=>{e(Object(C.b)(t))}})))(k),w=a(520),M=a(501),P=a(333),_=a(415),j=a(463),B=a.n(j),N=a(454),R=a(457),T=a.n(R),z=a(248),L=a.n(z);const A=({data:e})=>n.a.createElement("div",null,"Loading");class F extends s.PureComponent{constructor(e){super(e),this.handleKeyPress=this.handleKeyPress.bind(this),this.handleTextChange=this.handleTextChange.bind(this),this.sendMessage=this.sendMessage.bind(this),this.getEmojiSuggestions=this.getEmojiSuggestions.bind(this),this.getUsernameSuggestions=this.getUsernameSuggestions.bind(this),this.getCommandSuggestions=this.getCommandSuggestions.bind(this),this.renderNameSuggestion=this.renderNameSuggestion.bind(this),this.renderCharSuggestion=this.renderCharSuggestion.bind(this),this.rta=n.a.createRef(),this.state={text:"",commands:["help","discord","games","goto","source","fc","fixcontrollers","lock","unlock","forcegoto","setturnlength","setforfeitlength","sublist","modlist","pluslist","banlist","ban","unban"]}}handleKeyPress(e){"Enter"===e.key&&(e.preventDefault(),this.sendMessage())}handleTextChange(e){this.setState({text:e.target.value})}sendMessage(){""!==this.state.text&&(this.props.sendMessage(this.state.text),this.setState({text:""}),this.rta.setState({value:""}))}getEmojiSuggestions(e){return e.length<1?[]:T()(e).slice(0,5).map(({name:e,char:t})=>({name:e,char:t}))}getUsernameSuggestions(e){let t=[];for(let a in this.props.accountMap){let s=this.props.accountMap[a].username;if(null!=s&&-1!=s.toLowerCase().indexOf(e)){if(e.indexOf(s)>-1){t=[];break}t.push({name:s,char:`@${s}`})}}return t.slice(0,5)}getCommandSuggestions(e){let t=[];if(e.length<1)return[];for(let a=0;a<this.state.commands.length;a++){let s=this.state.commands[a];if(-1!=s.indexOf(e)){if(e.indexOf(s)>-1){t=[];break}t.push({name:s,char:"!"+s})}}return t.slice(0,5)}renderNameSuggestion(e){return n.a.createElement(P.a,null,n.a.createElement(_.a,null,e.entity.name))}renderCharSuggestion(e){return n.a.createElement(P.a,null,n.a.createElement(_.a,null,e.entity.char))}render(){const{classes:e}=this.props;return n.a.createElement(m.a,{id:"SendMessageForm",className:L()(e.root,e.container),elevation:0},n.a.createElement(N.a,{id:"messageBoxOld",className:e.messageBox,containerClassName:e.messageBoxContainer,loadingComponent:A,ref:e=>{this.rta=e},textAreaComponent:{component:M.a,ref:"inputRef"},minChar:0,trigger:{":":{dataProvider:this.getEmojiSuggestions,component:this.renderCharSuggestion,output:e=>({text:e.char,caretPosition:"next"})},"@":{dataProvider:this.getUsernameSuggestions,component:this.renderNameSuggestion,output:e=>({text:e.char,caretPosition:"next"})},"!":{dataProvider:this.getCommandSuggestions,component:this.renderNameSuggestion,output:e=>({text:e.char,caretPosition:"end"})}},onChange:this.handleTextChange,onKeyPress:this.handleKeyPress,value:this.state.text,placeholder:"Send a message",variant:"standard"}),n.a.createElement(w.a,{color:"primary",size:"small",onClick:this.sendMessage},n.a.createElement(B.a,{fontSize:"small"})))}}var H=Object(c.a)(Object(i.a)(e=>({root:{display:"flex",flexDirection:"row",justifyContent:"space-evenly",alignItems:"center",width:"100%",minHeight:"60px",height:"12%",paddingLeft:"5px",paddingRight:"5px"},messageBox:{display:"flex",resize:"none",borderRadius:"6px","&:focus":{outlineOffset:"0px !important",outline:"none !important",boxShadow:"0 0 3px blue !important"}},messageBoxContainer:{zIndex:1,width:"90%",fontSize:"14px",lineHeight:"20px",marginRight:"10px",position:"relative"},textField:{flex:"1",overflowY:"auto",height:"32px","&::-webkit-scrollbar":{width:"0 !important"},"& textarea":{overflow:"hidden"}},container:{"& .rta":{},"& .rta__loader.rta__loader--empty-suggestion-data":{borderRadius:"3px",boxShadow:"0 0 5px rgba(27, 31, 35, 0.1)",padding:"5px"},"& .rta--loading .rta__loader.rta__loader--suggestion-data":{position:"absolute",top:"0",left:"0",width:"100%",background:"rgba(255, 255, 255, 0.8)"},"& .rta--loading .rta__loader.rta__loader--suggestion-data > *":{position:"relative",top:"50%"},"& .rta__autocomplete":{position:"absolute",display:"block",marginTop:"1em"},"& .rta__autocomplete--top":{},"& .rta__list":{listStyle:"none",margin:"0px",padding:"0px",position:"relative",backgroundColor:e.palette.background.paper,boxShadow:"0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12)"},"& .rta__entity":{},"& .rta__entity:hover":{cursor:"pointer"},"& .rta__item:not(:last-child)":{},"& .rta__entity > *":{},"& .rta__entity--selected":{backgroundColor:e.palette.action.selected}},suggestion:{}})),Object(p.b)(e=>({accountMap:e.stream.accountMap}),e=>({sendMessage:t=>{e(Object(C.b)(t))}})))(F),U=a(250);class D extends s.PureComponent{constructor(e){super(e)}render(){const{classes:e}=this.props;return this.props.hide?null:n.a.createElement(m.a,{id:"chat",className:e.root},n.a.createElement(O,null),n.a.createElement("div",{style:{flex:1}}),n.a.createElement(H,null))}}t.default=Object(i.a)(e=>({root:{gridArea:"chat",display:"flex",flexDirection:"column",justifyContent:"space-between",padding:"5px",height:"300px",position:"relative"},[U.a.tablet]:{root:{height:"unset"}},[U.a.laptop]:{root:{}}}))(D)}}]);